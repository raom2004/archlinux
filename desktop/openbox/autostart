#
# These things are run when an Openbox X Session is started.
# You may place a similar script in $HOME/.config/openbox/autostart
# to run user-specific things.
#
# CODE:

### FUNCTION DECLARATION

############################################################
# Description:
#  function to open multiple urls in firefox with private mode
# pass an array as argument for a function
#  source:
#  https://duckduckgo.com/?q=bash+use+list+as+function+argument&t=ffab&atb=v344-5&ia=web&iax=qa
############################################################

function open_urls_in_firefox {
    a=("$@")
    for i in "${a[@]}" ; do
        firefox --private-window "$i" &
    done
}


### variable declaration

board_vendor=$(cat /sys/devices/virtual/dmi/id/board_vendor)
if [[ $board_vendor =~ apple ]]; then bright="25%"; else bright="50%"; fi


### ESSENTIAL SETUP 

# Keyboard Setup (set in script 2 instead)
xmodmap -e "keysym XF86Eject = BackSpace" &
setxkbmap -model pc105 -layout es,us,at -option grp:win_space_toggle &
# deactivate screen saver
(sleep 40 && xset s 0 0) &
# Screen Brigthness Setup
brightnessctl set "${bright}" &
# Set Background
~/.fehbg &
# Bar
tint2 &
# Tray Icons
nm-applet &             # network manager
xfce4-power-manager &   # battery info
# volume icon
(if [[ ! $board_vendor =~ apple ]]; then pasystray; fi) &
# permission to mount drives
if [[ ! ${board_vendor} =~ apple ]]; then
  /usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &
fi
# automount usb
udiskie --notify --automount --tray &
# Composite Manager
picom &
# System Monitor Software
(sleep 2 && conky) &
# amixer volume and musik player: run when sound card is recognixed
sh -c "until aplay -l | grep PCH; do sleep 10; done" \
    && (sleep 4 && sh -c "amixer sset Master unmute") \
    && (sleep 2 && sh -c "amixer set Master 2%+") \
    && (sleep 2 && sh -c "amixer set Master 25%") \
    && (sleep 2 && sh -c "audacious --headless --play") &


### START PROGRAMS

## start Terminal
(sleep 3 && open_xterm_custom "$HOME/Projects/archlinux/desktop/openbox" left) &
(sleep 4 && open_xterm_custom "$HOME/Projects/archlinux" middle) &
(sleep 5 && open_xterm_custom "$HOME/Projects/dot-emacs") &

## start file manager
thunar --daemon &

## open File Manager
(sleep 1 && thunar $HOME/Projects/archlinux) &
(sleep 2 && thunar $HOME/Projects/archlinux/desktop/openbox) &
(sleep 2 && thunar $HOME/Projects/dot-emacs) &
my_path=/run/media/*/EAFB-BEA4/share-projects/
(sleep 2 && if [[ -d "${my_path}" ]]; then thunar "${my_path}"; fi) &
unset my_path
## start Text/Code Editor
(sleep 6 && emacs -q -l $HOME/Projects/dot-emacs/init-openbox.el) &

## start Webbroser: open single url in privat mode
# url='https://wiki.archlinux.org/title/Openbox' \
#    | firefox --private-window "${url}" &

## start Webbroser: open multiples urls in private mode
# vim cheat sheet and cron
# urls=(
#     # cron
#     'https://wiki.archlinux.org/title/Cron'
#     # vim cheat sheet (pdf)
#     '/run/media/angel/KN28/emacshome/documents/reference/Programming(software-engineering)/vim/vim-commands-cheat-sheet-by-pnap.pdf'
# )
# open_urls_in_firefox "${urls[@]}"

## start Firefox
urls=(
    # vim command cheat sheet
    'https://phoenixnap.com/kb/vim-commands-cheat-sheet'

    # cron
    'https://wiki.archlinux.org/title/Cron'

    # systemd
    'https://wiki.archlinux.org/title/Systemd'
    'https://seb.jambor.dev/posts/systemd-by-example-part-1-minimization/'
    # openbox example for window snapping
    # 'https://wiki.archlinux.org/title/Openbox#Window_snapping'
    # 'http://openbox.org/wiki/Help:Actions#GrowToEdge'
    # 'https://aur.archlinux.org/packages/opensnap'
    # 'https://wiki.archlinux.org/title/X_keyboard_extension'
)
(sleep 4 && open_urls_in_firefox "${urls[@]}")

## minimize application
# wmctrl -ri "$(xwininfo -name "openbox" | awk '/Window id/{print $4}')" -b toggle,hidden
(sleep 6 && wmctrl -r "Firefox" -b toggle,hidden) &


# emacs:
# Local Variables:
# mode:Shell-script
# sh-basic-offset:2
# End:

# vim: set ts=2 sw=2 et:
