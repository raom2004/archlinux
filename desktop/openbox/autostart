#
# These things are run when an Openbox X Session is started.
# You may place a similar script in $HOME/.config/openbox/autostart
# to run user-specific things.
#
# CODE:

### FUNCTIONS DECLARATION

############################################################
# Description:
#  function to open multiple urls in firefox with private mode
# pass an array as argument for a function
#  source:
#  https://duckduckgo.com/?q=bash+use+list+as+function+argument&t=ffab&atb=v344-5&ia=web&iax=qa
############################################################

function open_urls_in_firefox {
    a=("$@")
    for i in "${a[@]}" ; do
        firefox --private-window "$i" &
    done
}


### ESSENTIAL SETUP 

## Keyboard Setup (set in script 2 instead)
xmodmap -e "keysym XF86Eject = BackSpace"

## Screen Brigthness Setup
if grep -i apple /sys/devices/virtual/dmi/id/board_vendor; then
    brightnessctl set 25% &
else
  brightnessctl set 50% &
fi

## Set Background
~/.fehbg &

## Bar
tint2 &

## Tray Icons
nm-applet &             # network manager
xfce4-power-manager &   # battery info

## permission to mount drives
/usr/lib/polkit-gnome/polkit-gnome-authentication-agent-1 &

## automount usb
udiskie --notify --automount --tray &

## Composite Manager
picom &

## System Monitor Software
(sleep 3 && conky) &

## amixer volume and musik player: run when sound card is recognixed
sh -c "until aplay -l | grep PCH; do sleep 10; done" \
    && (sleep 4 && sh -c "amixer sset Master unmute") \
    && (sleep 2 && sh -c "amixer set Master 2%+") \
    && (sleep 2 && sh -c "amixer set Master 25%") \
    && (sleep 2 && sh -c "audacious --headless --play") &


### START PROGRAMS

## File Manager
(sleep 4 && thunar $HOME/Projects/archlinux) &
(sleep 4 && thunar $HOME/Projects/archlinux/desktop/openbox) &
(sleep 4 && thunar $HOME/Projects/dot-emacs) &

## terminal:
#   Geometry Specifications: WIDTH x HEIGHT + XOFF + YOFF
#   total screen size in pixels can be shown by "xrandr"
#     Setting size: WIDTH x HEIGHT
#       xterm set size by character instead of pixels
#       using "xwininfo" you can get this info in pixels
#         WIDTH=60 (xwininfo Width = 544 / 9 ==> 60) 
#         HEIGHT=17 (xwininfo Height = 310 / 18 ==> 17)
#     Setting location: + XOFF - XOFF
#       Predefined values:
#         +0+0 = upper left hand corner. 
#         -0+0 = upper right hand corner. 
#         -0-0 = lower right hand corner. 
#         +0-0 = lower left hand corner.
#
#   source: https://linux.die.net/man/7/x
#
# variable declaration
X_size="$(xrandr | awk '/*/{print $1}' | awk -F'x' '{print $1}')"
X_center="$((X_size / 3))"
panel_height="$(awk '/panel_size/{print $4}' ~/.config/tint2/tint2rc)"
# open terminal, location: lower right hand corner
xterm -rv -fa 'Ubuntu Mono' -fs 12 -geometry 60x17-0-30 \
      -e "cd $HOME/Projects/dot-emacs; exec zsh" &
# open terminal, location: lower left hand corner
xterm -rv -fa 'Ubuntu Mono' -fs 12 -geometry "60x17+0-${panel_height}" \
      -e "cd $HOME/Projects/archlinux/desktop/openbox; exec zsh" &
# open terminal, location: center
xterm -rv -fa 'Ubuntu Mono' -fs 12 \
      -geometry 69x18+"${X_center}"-"${panel_height}" -e \
      "cd $HOME/Projects/archlinux; exec zsh" &


## webbroser : open unique url in privat mode

# url='https://wiki.archlinux.org/title/Openbox' \
#    | firefox --private-window "${url}" &

## webbroser : open multiples urls in private mode

# vim cheat sheet and cron
# urls=(
#     # cron
#     'https://wiki.archlinux.org/title/Cron'
#     # vim cheat sheet (pdf)
#     '/run/media/angel/KN28/emacshome/documents/reference/Programming(software-engineering)/vim/vim-commands-cheat-sheet-by-pnap.pdf'
# )
# open_urls_in_firefox "${urls[@]}"

urls=(
    # vim command cheat sheet
    'https://phoenixnap.com/kb/vim-commands-cheat-sheet'

    # cron
    'https://wiki.archlinux.org/title/Cron'

    # openbox example for window snapping
    'https://wiki.archlinux.org/title/Openbox#Window_snapping'
    'http://openbox.org/wiki/Help:Actions#GrowToEdge'
    'https://aur.archlinux.org/packages/opensnap'
)

open_urls_in_firefox "${urls[@]}"

## text/code editor
emacs -q -l ~/.emacs.d/init-openbox.el &

## Editor
emacs -q -l ~/.emacs.d/init-openbox.el &

## Musik player (will start when sound card is detected)
sh -c "until aplay -l | grep PCH; do sleep 5; done" \
    && (sleep 4 && sh -c "amixer sset Master unmute") \
    && (sleep 2 && sh -c "amixer set Master 2%+") \
    && (sleep 2 && sh -c "amixer set Master 12%") \
    && (sleep 2 && sh -c "audacious --headless --play") &


# emacs:
# Local Variables:
# mode:Shell-script
# sh-basic-offset:2
# End:

# vim: set ts=2 sw=2 et:
